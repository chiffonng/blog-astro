---
import RenderIcon from './RenderIcon.astro'

export enum ToolTag {
  OpenSource = 'oss',
  SelfHosted = 'self-hosted',
  Free = 'free',
  Paid = 'paid',
  Gifted = 'gifted',
  Subscription = 'subscription',
  Organization = 'org'
}

const tagStyles: Record<ToolTag, string> = {
  [ToolTag.OpenSource]: 'bg-yellow-500/20 text-yellow-600 dark:text-yellow-400',
  [ToolTag.SelfHosted]: 'bg-green-500/20 text-green-600 dark:text-green-400',
  [ToolTag.Free]: 'bg-muted text-muted-foreground',
  [ToolTag.Gifted]: 'bg-muted text-muted-foreground',
  [ToolTag.Paid]: 'bg-destructive/80 text-destructive-foreground',
  [ToolTag.Subscription]: 'bg-primary text-primary-foreground',
  [ToolTag.Organization]: 'bg-primary text-primary-foreground'
}

export interface ToolProps {
  name: string
  description: string
  href: string
  icon: Promise<typeof import('*.svg?raw')> | ImageMetadata
  darkIcon?: Promise<typeof import('*.svg?raw')> | ImageMetadata
  tags?: ToolTag[]
}

const { name, description, href, icon, darkIcon, tags } = Astro.props
---

<a class='group relative text-sm leading-normal no-underline' href={href} id={name} target='_blank'>
  <div
    class='flex items-center gap-x-3 rounded-lg border border-transparent px-1.5 py-1 transition-colors hover:border-border hover:bg-muted'
  >
    {
      darkIcon ? (
        <>
          <RenderIcon icon={icon} alt={name} hidden='dark:hidden' />
          <RenderIcon icon={darkIcon} alt={name} hidden='hidden dark:block' />
        </>
      ) : (
        <RenderIcon icon={icon} alt={name} />
      )
    }
    <div class='z-20 flex flex-col'>
      <div class='flex items-center gap-2'>
        <div class='font-medium text-foreground'>{name}</div>
        <div class='flex gap-1'>
          {
            tags
              ?.filter((tag: ToolTag) => Object.values(ToolTag).includes(tag))
              .map((tag: ToolTag) => (
                <span class={`text-xs px-1.5 py-0.5 rounded ${tagStyles[tag] ?? ''}`}>{tag}</span>
              ))
          }
        </div>
      </div>
      <div class='font-normal'>{description}</div>
    </div>
  </div>
</a>
